webpackJsonp([6],{"66+J":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xxa5"),i=n.n(r),a=n("exGp"),s=n.n(a),l=n("wOqb"),o=n("JzPK"),u={name:"Note",data:function(){return{title:"无标题文章",note:"",userId:"",render:"",relatedImg:"",thumbnailArticle:""}},mounted:function(){this.userId=window.sessionStorage.getItem("userId")},methods:{limitImput:function(){this.title=this.title.replace(/[^\u4E00-\u9FA5-Za-z]/g,"")},imgAdd:function(e,t){var n=this;return s()(i.a.mark(function r(){var a,s;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(a=new FormData).append("imgFile",t),r.next=4,l.k(a);case 4:s=r.sent,n.$refs.md.$img2Url(e,s.url);case 6:case"end":return r.stop()}},r,n)}))()},publishBlog:function(){var e=this;return s()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(document.getElementsByClassName("fa-mavon-floppy-o")[0].click(),!e.render){t.next=6;break}return t.next=4,l.h(e.userId,e.title,e.render,e.relatedImg,e.thumbnailArticle,o.a.getCurrentTime());case 4:(n=t.sent)&&(2e6===n.code?e.$router.push({name:"BlogList"}):e.$Message.error(n.message));case 6:case"end":return t.stop()}},t,e)}))()},saveNote:function(e,t){var n=this;if(this.render=t,t){var r=t.match(/<img[^>]+>/g),i=t.replace(/[\r\n]/g,""),a=new RegExp("<p.*?>(.*?)</p>","i");this.thumbnailArticle=i.match(a)[1],r&&(this.relatedImg=r[0].match(/src=[\'\"]?([^\'\"]*)[\'\"]?/i)[1],r.forEach(function(e,t){0===t&&(n.thumbnailArticle=i.substring(3,i.indexOf(e)))})),this.title||(this.title="无标题文章")}else this.$Message.warning("内容不能为空")}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"write-note"},[n("Input",{staticClass:"note-title",attrs:{placeholder:"无标题文章"},nativeOn:{keyup:function(t){return e.limitImput(t)}},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),e._v(" "),n("mavon-editor",{ref:"md",attrs:{ishljs:!0},on:{imgAdd:e.imgAdd,save:e.saveNote},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),e._v(" "),n("Button",{staticClass:"publish-btn",attrs:{icon:"paper-airplane",type:"text"},on:{click:e.publishBlog}},[e._v("发布")])],1)},staticRenderFns:[]};var m=n("VU/8")(u,c,!1,function(e){n("xWKR")},null,null);t.default=m.exports},xWKR:function(e,t){}});
//# sourceMappingURL=NoteBooks.js.map